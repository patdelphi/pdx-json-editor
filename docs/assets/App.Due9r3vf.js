import{j as e}from"./index.BVtPNbso.js";import{r as t,F as r}from"./ui.BbRMDCnW.js";import"./monaco.fvmTPtOA.js";import"./react.BI3NJeJA.js";const n=t.forwardRef(({value:n,onChange:s,onValidationChange:o,onCursorPositionChange:a,onSelectionChange:i,theme:l,settings:c},d)=>{const u=t.useRef(null),m=t.useRef(null),g=t.useCallback(()=>{u.current&&u.current.trigger("editor","editor.action.formatDocument",{})},[]),h=t.useCallback(()=>{u.current&&u.current.trigger("editor","undo",{})},[]),x=t.useCallback(()=>{u.current&&u.current.trigger("editor","redo",{})},[]),f=t.useCallback(()=>{u.current&&u.current.trigger("editor","editor.action.selectAll",{})},[]),p=t.useCallback(()=>{if(u.current)try{u.current.focus();const t=u.current,r=m.current;try{return void t.trigger("keyboard","actions.find",null)}catch(e){}try{return void t.trigger("keyboard","editor.action.startFindAction",null)}catch(e){}try{const e=[],r=t.getAction("actions.find"),n=t.getAction("editor.action.startFindAction");r&&e.push(r),n&&e.push(n);const s=e.find(e=>"actions.find"===e.id||"editor.action.startFindAction"===e.id||e.id.toLowerCase().includes("find"));if(s)return void s.run()}catch(e){}try{if(r)return void t.trigger("keyboard",r.KeyMod.CtrlCmd|r.KeyCode.KeyF,null)}catch(e){}try{window.find()}catch(e){}}catch(t){}},[]),y=t.useCallback(()=>{if(u.current)try{u.current.focus();const t=u.current,r=m.current;try{return void t.trigger("keyboard","editor.action.startFindReplaceAction",null)}catch(e){}try{return void t.trigger("keyboard","actions.findWithReplace",null)}catch(e){}try{const e=[],r=t.getAction("editor.action.startFindReplaceAction"),n=t.getAction("actions.findWithReplace");r&&e.push(r),n&&e.push(n);const s=e.find(e=>"editor.action.startFindReplaceAction"===e.id||"actions.findWithReplace"===e.id||e.id.toLowerCase().includes("replace"));if(s)return void s.run()}catch(e){}try{if(r)return void t.trigger("keyboard",r.KeyMod.CtrlCmd|r.KeyCode.KeyH,null)}catch(e){}}catch(t){}},[]),b=t.useCallback((e,t)=>{u.current&&(u.current.revealLineInCenter(e),u.current.setPosition({lineNumber:e,column:t||1}),u.current.focus())},[]),k=t.useCallback(()=>u.current?u.current.getSelection():null,[]),v=t.useCallback(()=>{if(u.current){const e=u.current.getSelection(),t=u.current.getModel();if(e&&t)return t.getValueInRange(e)}return""},[]),w=t.useCallback(e=>{if(u.current){const t=u.current.getSelection()||new m.current.Range(1,1,1,1);u.current.executeEdits("insert-text",[{range:t,text:e,forceMoveMarkers:!0}])}},[]),C=t.useCallback(()=>{if(u.current){const e=u.current.getModel();return!!e&&e.canUndo()}return!1},[]),j=t.useCallback(()=>{if(u.current){const e=u.current.getModel();return!!e&&e.canRedo()}return!1},[]);t.useImperativeHandle(d,()=>({formatDocument:g,undo:h,redo:x,selectAll:f,find:p,replace:y,gotoLine:b,getSelection:k,getSelectedText:v,insertText:w,canUndo:C,canRedo:j,focus:()=>u.current?.focus(),getEditor:()=>u.current,getMonaco:()=>m.current}),[g,h,x,f,p,y,b,k,v,w,C,j]);t.useEffect(()=>{u.current&&u.current.updateOptions({tabSize:c.indentSize,insertSpaces:"spaces"===c.indentType,wordWrap:c.wordWrap?"on":"off",lineNumbers:c.lineNumbers?"on":"off",minimap:{enabled:c.minimap}})},[c]);const N={language:"json",theme:"dark"===l?"vs-dark":"vs",automaticLayout:!0,fontSize:14,fontFamily:'Monaco, Menlo, "Ubuntu Mono", monospace',tabSize:c.indentSize,insertSpaces:"spaces"===c.indentType,wordWrap:c.wordWrap?"on":"off",lineNumbers:c.lineNumbers?"on":"off",minimap:{enabled:c.minimap},scrollBeyondLastLine:!1,renderWhitespace:"selection",bracketPairColorization:{enabled:!0},matchBrackets:"always",showFoldingControls:"always",foldingStrategy:"indentation",foldingHighlight:!0,autoClosingBrackets:"always",autoClosingQuotes:"always",autoClosingDelete:"always",autoClosingOvertype:"always",autoSurround:"languageDefined",autoIndent:"full",formatOnPaste:!0,formatOnType:!0,suggest:{showKeywords:!0,showSnippets:!0,showFunctions:!0,showConstructors:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showIssues:!0,showUsers:!0,insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1},quickSuggestions:{other:!0,comments:!1,strings:!0},multiCursorModifier:"ctrlCmd",multiCursorMergeOverlapping:!0,multiCursorPaste:"spread",find:{addExtraSpaceOnTop:!0,autoFindInSelection:"never",seedSearchStringFromSelection:"always",loop:!0},renderValidationDecorations:"on",renderLineHighlight:"all",renderLineHighlightOnlyWhenFocus:!1,undoStopOnWordBoundary:!0,largeFileOptimizations:!0,accessibilitySupport:"auto",ariaLabel:"PDX JSON Editor",cursorBlinking:"blink",cursorSmoothCaretAnimation:"on",cursorStyle:"line",cursorWidth:2,smoothScrolling:!0,mouseWheelScrollSensitivity:1,fastScrollSensitivity:5};return e.jsx("div",{className:"w-full h-full",children:e.jsx(r,{value:n,onChange:e=>{void 0!==e&&s(e)},onMount:(e,t)=>{u.current=e,m.current=t,e.updateOptions({find:{addExtraSpaceOnTop:!0,autoFindInSelection:"never",seedSearchStringFromSelection:"always",loop:!0}}),t.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!1,schemas:[],enableSchemaRequest:!1,schemaValidation:"error",schemaRequest:"error"}),t.languages.setLanguageConfiguration("json",{brackets:[["{","}"],["[","]"],['"','"']],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:'"',close:'"',notIn:["string"]}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:'"',close:'"'}]});const r=e.getContribution("editor.contrib.findController");r&&"function"==typeof r.getState&&e.onDidBlurEditorWidget(()=>{setTimeout(()=>{try{const e=r.getState();e&&e.isRevealed&&r.focus&&r.focus()}catch(e){}},100)}),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyF,()=>{const t=[],r=e.getAction("actions.find"),n=e.getAction("editor.action.startFindAction");r&&t.push(r),n&&t.push(n);const s=t.find(e=>"actions.find"===e.id||"editor.action.startFindAction"===e.id);s?s.run():e.trigger("keyboard","actions.find",null)}),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyH,()=>{const t=[],r=e.getAction("editor.action.startFindReplaceAction"),n=e.getAction("actions.findWithReplace");r&&t.push(r),n&&t.push(n);const s=t.find(e=>"editor.action.startFindReplaceAction"===e.id);s?s.run():e.trigger("keyboard","editor.action.startFindReplaceAction",null)});const n=e.getModel();if(n){const r=t.editor.onDidChangeMarkers(e=>{const r=n.uri;if(e.find(e=>e.toString()===r.toString())){const e=t.editor.getModelMarkers({resource:r}).map(e=>({line:e.startLineNumber,column:e.startColumn,message:e.message,severity:e.severity===t.MarkerSeverity.Error?"error":"warning"}));o(e)}}),s=e.onDidChangeCursorPosition(e=>{a&&a({line:e.position.lineNumber,column:e.position.column})}),l=e.onDidChangeCursorSelection(e=>{i&&i({startLine:e.selection.startLineNumber,startColumn:e.selection.startColumn,endLine:e.selection.endLineNumber,endColumn:e.selection.endColumn})}),c=n.onDidChangeContent(()=>{});return e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KeyD,()=>{e.trigger("keyboard","editor.action.copyLinesDownAction",{})}),e.addCommand(t.KeyMod.CtrlCmd|t.KeyMod.Shift|t.KeyCode.KeyK,()=>{e.trigger("keyboard","editor.action.deleteLines",{})}),e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.Slash,()=>{e.trigger("keyboard","editor.action.commentLine",{})}),()=>{r.dispose(),s.dispose(),l.dispose(),c.dispose()}}},options:N,loading:e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-gray-500",children:"Loading editor..."})})})})}),s=({theme:t,onThemeChange:r,disabled:n=!1})=>{const s=`\n    relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ease-in-out\n    ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n    ${"dark"===t?"bg-blue-600":"bg-gray-200"}\n    focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n  `,o=`\n    inline-block h-4 w-4 transform rounded-full bg-white transition duration-200 ease-in-out\n    ${"dark"===t?"translate-x-6":"translate-x-1"}\n  `;return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm "+("light"===t?"text-yellow-500":"text-gray-400"),title:"Light theme",children:"☀️"}),e.jsx("button",{type:"button",className:s,onClick:()=>{n||r("light"===t?"dark":"light")},disabled:n,role:"switch","aria-checked":"dark"===t,"aria-label":`Switch to ${"light"===t?"dark":"light"} theme`,children:e.jsx("span",{className:o})}),e.jsx("span",{className:"text-sm "+("dark"===t?"text-blue-400":"text-gray-400"),title:"Dark theme",children:"🌙"}),e.jsx("span",{className:"text-sm font-medium "+("dark"===t?"text-gray-200":"text-gray-700"),children:"light"===t?"Light":"Dark"})]})},o=100,a=9e3,i=9100,l=({isOpen:r,onClose:n,settings:o,onSettingsChange:l,theme:c,onThemeChange:d})=>{const[u,m]=t.useState(o),g=t.useRef(null);t.useEffect(()=>{m(o)},[o]);const h=(e,t)=>{const r={...u,[e]:t};m(r),l({[e]:t})};return t.useEffect(()=>{const e=e=>{"Escape"===e.key&&r&&n()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[r,n]),t.useEffect(()=>{r&&g.current&&g.current.focus()},[r]),r?e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:a},children:e.jsxs("div",{ref:g,tabIndex:-1,style:{backgroundColor:"dark"===c?"#1f2937":"white",borderRadius:"0.5rem",padding:"1.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)",maxHeight:"80vh",overflowY:"auto",width:"95%",maxWidth:"450px",position:"relative",zIndex:i},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"编辑器设置"}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-xl font-bold w-8 h-8 flex items-center justify-center rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"关闭设置",children:"✕"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-3",children:"外观"}),e.jsx("div",{className:"pl-4",children:e.jsx(s,{theme:c,onThemeChange:d})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-3",children:"编辑器"}),e.jsxs("div",{className:"space-y-4 pl-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"缩进大小"}),e.jsxs("select",{value:u.indentSize,onChange:e=>h("indentSize",Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:2,children:"2 个空格"}),e.jsx("option",{value:4,children:"4 个空格"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"缩进类型"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"indentType",value:"spaces",checked:"spaces"===u.indentType,onChange:e=>h("indentType",e.target.value),className:"mr-2 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"空格"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"indentType",value:"tabs",checked:"tabs"===u.indentType,onChange:e=>h("indentType",e.target.value),className:"mr-2 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"制表符"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.wordWrap,onChange:e=>h("wordWrap",e.target.checked),className:"mr-3 text-blue-600 focus:ring-blue-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"自动换行"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6",children:"将长行自动换行以适应编辑器宽度"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.lineNumbers,onChange:e=>h("lineNumbers",e.target.checked),className:"mr-3 text-blue-600 focus:ring-blue-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"行号"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6",children:"在编辑器中显示行号"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.minimap,onChange:e=>h("minimap",e.target.checked),className:"mr-3 text-blue-600 focus:ring-blue-500 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"缩略图"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 ml-6",children:"显示文档的缩略图概览"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-8 pt-4 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("button",{onClick:()=>{const e={indentSize:2,indentType:"spaces",wordWrap:!1,lineNumbers:!0,minimap:!0};m(e),l(e)},className:"px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors",children:"重置为默认值"}),e.jsx("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"完成"})]})]})}):null},c=({onOpen:r,onSave:n,onNew:s,isDirty:o,currentFile:a,theme:i,disabled:l=!1})=>{const c=t.useRef(null),u=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=e=>t(e.target?.result),n.onerror=()=>r(new Error("Failed to read file")),n.readAsText(e)}),m=`\n    px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 flex items-center space-x-2\n    ${"dark"===i?"text-gray-300 hover:text-white hover:bg-gray-700 border-gray-600":"text-gray-700 hover:text-gray-900 hover:bg-gray-50 border-gray-300"}\n    ${l?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n    border\n  `,g=`\n    px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 flex items-center space-x-2\n    bg-blue-600 hover:bg-blue-700 text-white\n    ${l?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n  `;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{ref:c,type:"file",accept:".json,.txt",onChange:async e=>{const t=e.target.files?.[0];if(t){try{const e=await u(t),n={name:t.name,size:t.size,lastModified:new Date(t.lastModified),content:e};r(n)}catch(n){}c.current&&(c.current.value="")}},className:"hidden","aria-label":"Select JSON file"}),e.jsxs("button",{onClick:()=>{l||s()},className:m,disabled:l,title:"创建新文件 (Ctrl+N)",children:[e.jsx("span",{children:"📄"}),e.jsx("span",{children:"新建"})]}),e.jsxs("button",{onClick:()=>{l||c.current?.click()},className:m,disabled:l,title:"打开文件 (Ctrl+O)",children:[e.jsx("span",{children:"📁"}),e.jsx("span",{children:"打开"})]}),e.jsxs("button",{onClick:()=>{l||n()},className:o?g:m,disabled:l,title:"保存文件 (Ctrl+S)",children:[e.jsx("span",{children:"💾"}),e.jsx("span",{children:"保存"}),o&&e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full ml-1",title:"未保存的更改"})]}),a&&e.jsx("div",{className:`\n          px-3 py-2 text-sm rounded-md border\n          ${"dark"===i?"bg-gray-800 border-gray-600 text-gray-300":"bg-gray-50 border-gray-300 text-gray-600"}\n        `,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:a.name}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",d(a.size),")"]}),o&&e.jsx("span",{className:"text-orange-500 text-xs",children:"●"})]})})]})},d=e=>e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`,u=({onFileDrop:r,onError:n,theme:s,disabled:o=!1,children:a})=>{const[i,l]=t.useState(!1),[c,d]=t.useState(0),u=async e=>{if((e=>["application/json","text/plain"].includes(e.type)||[".json",".txt"].some(t=>e.name.toLowerCase().endsWith(t))?!(e.size>10485760&&(n("File size must be less than 10MB"),1)):(n("Please select a JSON or text file"),!1))(e))try{const t=await(e=>new Promise((t,r)=>{const n=new FileReader;n.onload=e=>t(e.target?.result),n.onerror=()=>r(new Error("Failed to read file")),n.readAsText(e)}))(e),n={name:e.name,size:e.size,lastModified:new Date(e.lastModified),content:t};r(n)}catch(t){n("Failed to read file content")}},m=t.useCallback(e=>{e.preventDefault(),e.stopPropagation(),o||(d(e=>e+1),e.dataTransfer.items&&e.dataTransfer.items.length>0&&l(!0))},[o]),g=t.useCallback(e=>{e.preventDefault(),e.stopPropagation(),o||d(e=>{const t=e-1;return 0===t&&l(!1),t})},[o]),h=t.useCallback(e=>{e.preventDefault(),e.stopPropagation(),o||(e.dataTransfer.dropEffect="copy")},[o]),x=t.useCallback(async e=>{if(e.preventDefault(),e.stopPropagation(),o)return;l(!1),d(0);const t=Array.from(e.dataTransfer.files);0!==t.length?t.length>1?n("Please drop only one file at a time"):await u(t[0]):n("No files were dropped")},[o,n]),f=`\n    absolute inset-0 z-10 flex items-center justify-center\n    ${"dark"===s?"bg-gray-900/80 border-blue-400":"bg-white/80 border-blue-500"}\n    border-2 border-dashed rounded-lg transition-all duration-200\n    ${i?"opacity-100":"opacity-0 pointer-events-none"}\n  `,p=`\n    px-6 py-4 rounded-lg text-center\n    ${"dark"===s?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-700 border-gray-300"}\n    border shadow-lg\n  `;return e.jsxs("div",{className:"relative w-full h-full",onDragEnter:m,onDragLeave:g,onDragOver:h,onDrop:x,children:[a,e.jsx("div",{className:f,children:e.jsxs("div",{className:p,children:[e.jsx("div",{className:"text-2xl mb-2",children:"📁"}),e.jsx("div",{className:"text-lg font-medium mb-1",children:"Drop your JSON file here"}),e.jsx("div",{className:"text-sm opacity-75",children:"Supports .json and .txt files (max 10MB)"})]})})]})},m=({isVisible:r,onSearch:n,onReplace:s,onReplaceAll:a,onFindNext:i,onFindPrevious:l,theme:c})=>{const[d,u]=t.useState(""),[m,g]=t.useState(""),[h,x]=t.useState(!1),[f,p]=t.useState({caseSensitive:!1,useRegex:!1,wholeWord:!1}),y=t.useRef(null);t.useEffect(()=>{r&&y.current&&y.current.focus()},[r]),t.useEffect(()=>{d.trim()&&n(d,f)},[d,f,n]);const b=e=>{p(t=>({...t,[e]:!t[e]}))},k=`\n    w-full px-2 py-1 text-xs border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500\n    ${"dark"===c?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-700 border-gray-300"}\n  `,v=`\n    px-1.5 py-0.5 text-xs font-medium rounded-md transition-colors\n    ${"dark"===c?"bg-gray-700 hover:bg-gray-600 text-gray-200 border-gray-600":"bg-gray-100 hover:bg-gray-200 text-gray-700 border-gray-300"}\n    border\n  `,w=e=>`\n    px-1.5 py-0.5 text-xs font-medium rounded-md transition-colors border\n    ${"dark"===c?e?"bg-blue-600 text-white border-blue-700":"bg-gray-700 text-gray-300 border-gray-600 hover:bg-gray-600":e?"bg-blue-500 text-white border-blue-600":"bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200"}\n  `;return e.jsx("div",{className:"flex-shrink-0 "+(r?"":"hidden"),style:{backgroundColor:"dark"===c?"#1f2937":"white",borderLeft:"1px solid "+("dark"===c?"#374151":"#e5e7eb"),color:"dark"===c?"#f3f4f6":"#111827",padding:"0.25rem 0.5rem",zIndex:o,height:"100%",display:"flex",alignItems:"center",position:"absolute",right:0,top:0},children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("input",{ref:y,type:"text",value:d,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey?l():i(),e.preventDefault())},placeholder:"搜索...",className:k,style:{width:"150px"}}),e.jsx("button",{className:w(f.caseSensitive),onClick:()=>b("caseSensitive"),title:"区分大小写",children:"Aa"}),e.jsx("button",{className:w(f.wholeWord),onClick:()=>b("wholeWord"),title:"全字匹配",children:"W"}),e.jsx("button",{className:w(f.useRegex),onClick:()=>b("useRegex"),title:"使用正则表达式",children:".*"}),e.jsx("button",{className:v,onClick:l,title:"查找上一个 (Shift+Enter)",children:"↑"}),e.jsx("button",{className:v,onClick:i,title:"查找下一个 (Enter)",children:"↓"}),e.jsx("button",{className:v,onClick:()=>x(!h),title:h?"隐藏替换":"显示替换",children:h?"−":"+"}),h&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",value:m,onChange:e=>g(e.target.value),placeholder:"替换为...",className:k,style:{width:"120px"}}),e.jsx("button",{className:v,onClick:()=>{d.trim()&&s(d,m,f)},title:"替换",children:"替换"}),e.jsx("button",{className:v,onClick:()=>{d.trim()&&a(d,m,f)},title:"全部替换",children:"全部"})]})]})})};class g extends t.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}handleRetry=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Something went wrong"})})]}),e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"The JSON Editor encountered an unexpected error. You can try to recover by clicking the buttons below."})}),!1,e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:this.handleRetry,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Try Again"}),e.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",children:"Reload Page"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"If the problem persists, please refresh the page or contact support."})})]})}):this.props.children}}const h=({toast:r,onClose:n})=>{const[s,o]=t.useState(!1),[a,i]=t.useState(!1);t.useEffect(()=>{const e=setTimeout(()=>o(!0),10);return()=>clearTimeout(e)},[]),t.useEffect(()=>{const e=r.duration??5e3;if(e>0){const t=setTimeout(()=>{l()},e);return()=>clearTimeout(t)}},[r.duration]);const l=()=>{i(!0),setTimeout(()=>{n(r.id)},300)};return e.jsxs("div",{className:(()=>{const e=`\n      relative flex items-start p-4 mb-3 rounded-lg shadow-lg border-l-4 transition-all duration-300 ease-in-out\n      ${s&&!a?"translate-x-0 opacity-100":"translate-x-full opacity-0"}\n    `;switch(r.type){case"success":return`${e} bg-green-50 dark:bg-green-900/20 border-green-500 text-green-800 dark:text-green-200`;case"error":return`${e} bg-red-50 dark:bg-red-900/20 border-red-500 text-red-800 dark:text-red-200`;case"warning":return`${e} bg-yellow-50 dark:bg-yellow-900/20 border-yellow-500 text-yellow-800 dark:text-yellow-200`;case"info":return`${e} bg-blue-50 dark:bg-blue-900/20 border-blue-500 text-blue-800 dark:text-blue-200`;default:return`${e} bg-gray-50 dark:bg-gray-800 border-gray-500 text-gray-800 dark:text-gray-200`}})(),children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:(()=>{switch(r.type){case"success":return e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return e.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case"info":return e.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})});default:return null}})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium",children:r.title}),r.message&&e.jsx("p",{className:"mt-1 text-sm opacity-90",children:r.message}),r.action&&e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:r.action.onClick,className:"text-sm font-medium underline hover:no-underline focus:outline-none",children:r.action.label})})]}),e.jsx("button",{onClick:l,className:"flex-shrink-0 ml-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})},x=({toasts:t,onRemoveToast:r,position:n="top-right"})=>0===t.length?null:e.jsx("div",{className:(()=>{const e="fixed z-50 max-w-sm w-full";switch(n){case"top-right":default:return`${e} top-4 right-4`;case"top-left":return`${e} top-4 left-4`;case"bottom-right":return`${e} bottom-4 right-4`;case"bottom-left":return`${e} bottom-4 left-4`;case"top-center":return`${e} top-4 left-1/2 transform -translate-x-1/2`;case"bottom-center":return`${e} bottom-4 left-1/2 transform -translate-x-1/2`}})(),children:t.map(t=>e.jsx(h,{toast:t,onClose:r},t.id))}),f=({isOpen:r,onClose:n,title:s,children:o,type:l="info",actions:c})=>{const[d,u]=t.useState(!1),m=t.useRef(null);if(t.useEffect(()=>{const e=e=>{"Escape"===e.key&&r&&n()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[r,n]),t.useEffect(()=>{r?requestAnimationFrame(()=>{requestAnimationFrame(()=>{u(!0)})}):u(!1)},[r]),t.useEffect(()=>{r&&m.current&&m.current.focus()},[r]),!r)return null;return e.jsxs("div",{className:"fixed inset-0 overflow-y-auto",style:{zIndex:a,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},"aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",opacity:d?1:0,transition:"opacity 0.2s ease-in-out"},"aria-hidden":"true",onClick:n}),e.jsxs("div",{ref:m,tabIndex:-1,style:{backgroundColor:"white",borderRadius:"0.5rem",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)",width:"100%",maxWidth:"500px",margin:"0 1rem",opacity:d?1:0,transform:d?"scale(1)":"scale(0.95)",transition:"opacity 0.2s ease-in-out, transform 0.2s ease-in-out",zIndex:i,position:"relative",overflow:"hidden"},onClick:e=>e.stopPropagation(),children:[e.jsx("div",{style:{padding:"1.5rem 1.5rem 1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start"},children:[(()=>{switch(l){case"success":return e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30",children:e.jsx("svg",{className:"h-6 w-6 text-green-600 dark:text-green-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})});case"error":return e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30",children:e.jsx("svg",{className:"h-6 w-6 text-red-600 dark:text-red-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})});case"warning":return e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30",children:e.jsx("svg",{className:"h-6 w-6 text-yellow-600 dark:text-yellow-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})});default:return e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900/30",children:e.jsx("svg",{className:"h-6 w-6 text-blue-600 dark:text-blue-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}})(),e.jsxs("div",{style:{marginLeft:"1rem",width:"100%"},children:[e.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:600,marginTop:0,marginBottom:"0.5rem",color:"#111827"},id:"modal-title",children:s}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#4B5563"},children:o})]})]})}),e.jsx("div",{style:{backgroundColor:"#F9FAFB",padding:"0.75rem 1.5rem",display:"flex",justifyContent:"flex-end",borderTop:"1px solid #E5E7EB"},children:c||e.jsx("button",{type:"button",style:{backgroundColor:"#3B82F6",color:"white",fontWeight:500,padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer"},onClick:n,children:"确定"})})]})]})};function p(){const[r,s]=t.useState('{\n  "example": "JSON content",\n  "number": 42,\n  "boolean": true\n}'),[o,a]=t.useState([]),[i,d]=t.useState("light"),[h,p]=t.useState({line:1,column:1}),[y,b]=t.useState({startLine:1,startColumn:1,endLine:1,endColumn:1}),[k,v]=t.useState(!1),[w,C]=t.useState(!1),[j,N]=t.useState(null),[S,R]=t.useState(!1),[L,E]=t.useState('{\n  "example": "JSON content",\n  "number": 42,\n  "boolean": true\n}'),F=t.useRef(null),{toasts:M,removeToast:O}=(()=>{const[e,r]=t.useState([]),n=t.useCallback((e,t,n,s)=>{const o=Date.now().toString()+Math.random().toString(36).substr(2,9),a={id:o,type:e,title:t,message:n,duration:s?.duration??("error"===e?0:5e3),action:s?.action};return r(e=>[...e,a]),o},[]),s=t.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),o=t.useCallback(()=>{r([])},[]),a=t.useCallback((e,t,r)=>n("success",e,t,r),[n]),i=t.useCallback((e,t,r)=>n("error",e,t,{duration:0,...r}),[n]),l=t.useCallback((e,t,r)=>n("warning",e,t,r),[n]),c=t.useCallback((e,t,r)=>n("info",e,t,r),[n]);return{toasts:e,addToast:n,removeToast:s,clearAllToasts:o,showSuccess:a,showError:i,showWarning:l,showInfo:c}})(),{isOpen:K,options:T,closeModal:A,showError:z,showSuccess:D,showConfirm:W}=(()=>{const[e,r]=t.useState(!1),[n,s]=t.useState({title:"",message:"",type:"info",confirmText:"确定",cancelText:"取消",showCancel:!1}),o=t.useCallback(e=>{s(t=>({...t,...e})),r(!0)},[]),a=t.useCallback(()=>{r(!1)},[]),i=t.useCallback((e,t,r)=>{o({title:e,message:t,type:"success",onConfirm:r,showCancel:!1})},[o]),l=t.useCallback((e,t,r)=>{o({title:e,message:t,type:"error",onConfirm:r,showCancel:!1})},[o]),c=t.useCallback((e,t,r,n)=>{o({title:e,message:t,type:"warning",onConfirm:r,onCancel:n,showCancel:!0})},[o]),d=t.useCallback((e,t,r,n)=>{o({title:e,message:t,type:"info",onConfirm:r,onCancel:n,showCancel:!0})},[o]);return{isOpen:e,options:n,openModal:o,closeModal:a,showSuccess:i,showError:l,showWarning:c,showConfirm:d}})(),[$,P]=t.useState({indentSize:2,indentType:"spaces",wordWrap:!1,lineNumbers:!0,minimap:!0}),B=()=>{d(e=>"light"===e?"dark":"light")},J=()=>{v(e=>!e)},I=e=>{S?W("未保存的更改","您有未保存的更改。是否要放弃这些更改？",()=>{N(e),s(e.content),E(e.content),R(!1)}):(N(e),s(e.content),E(e.content),R(!1))},V=()=>{const e=j?.name||"untitled.json",t=new Blob([r],{type:"application/json"}),n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n),E(r),R(!1),D("文件已保存",`成功保存文件 ${e}`)},H=()=>{if(S)return void W("未保存的更改","您有未保存的更改。是否要放弃这些更改？",()=>{const e="{\n  \n}";N(null),s(e),E(e),R(!1)});const e="{\n  \n}";N(null),s(e),E(e),R(!1)},U=e=>{s(e),R(e!==L)},q=()=>{try{const e=JSON.parse(r),t=JSON.stringify(e,null,$.indentSize);s(t),R(t!==L),D("JSON 格式化成功","您的 JSON 已成功格式化。")}catch(e){z("格式化错误","无法格式化无效的 JSON。请先修复语法错误。")}},G=()=>{try{const e=JSON.parse(r),t=JSON.stringify(e);s(t),R(t!==L),D("JSON 压缩成功","您的 JSON 已成功压缩。")}catch(e){z("压缩错误","无法压缩无效的 JSON。请先修复语法错误。")}},Q=()=>{try{JSON.parse(r),D("JSON 验证通过","您的 JSON 语法有效！")}catch(e){z("JSON 验证失败",`JSON 语法错误: ${e.message}`)}};return((e,r={})=>{const{enabled:n=!0,target:s=document}=r,o=t.useRef(e);t.useEffect(()=>{o.current=e},[e]);const a=t.useCallback(e=>{const t=e;if(!n)return;const r=o.current.find(e=>{const r=e.key.toLowerCase()===t.key.toLowerCase()||e.key.toLowerCase()===t.code.toLowerCase(),n=(e.ctrlKey??!1)===t.ctrlKey,s=(e.shiftKey??!1)===t.shiftKey,o=(e.altKey??!1)===t.altKey,a=(e.metaKey??!1)===t.metaKey;return r&&n&&s&&o&&a});r&&(!1!==r.preventDefault&&(e.preventDefault(),e.stopPropagation()),r.action())},[n]);t.useEffect(()=>{if(!n)return;const e=s;return e.addEventListener("keydown",a),()=>{e.removeEventListener("keydown",a)}},[a,n,s]),t.useCallback(()=>e.map(e=>({keys:[e.ctrlKey&&"Ctrl",e.metaKey&&"Cmd",e.shiftKey&&"Shift",e.altKey&&"Alt",e.key].filter(Boolean).join(" + "),description:e.description})),[e])})([{key:"n",ctrlKey:!0,action:H,description:"Create new file"},{key:"o",ctrlKey:!0,action:()=>{const e=document.querySelector('input[type="file"]');e?.click()},description:"Open file"},{key:"s",ctrlKey:!0,action:V,description:"Save file"},{key:"f",ctrlKey:!0,action:()=>{if(F.current)try{return F.current.focus&&F.current.focus(),void setTimeout(()=>{F.current?.find()},0)}catch(e){}C(e=>!e)},description:"Find/Search"},{key:"h",ctrlKey:!0,action:()=>{if(F.current)try{F.current.focus&&F.current.focus(),setTimeout(()=>{F.current?.replace()},0)}catch(e){}},description:"Find and Replace"},{key:",",ctrlKey:!0,action:J,description:"Open settings"},{key:"Enter",ctrlKey:!0,shiftKey:!0,action:q,description:"Format JSON"},{key:"Enter",ctrlKey:!0,altKey:!0,action:G,description:"Minify JSON"},{key:"Enter",ctrlKey:!0,action:Q,description:"Validate JSON"},{key:"d",ctrlKey:!0,action:B,description:"Toggle dark/light theme"}]),e.jsx(g,{children:e.jsxs("div",{className:"h-screen flex flex-col bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[e.jsxs("header",{className:"h-12 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center px-4 flex-shrink-0",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"PDX JSON 编辑器"}),e.jsx("div",{className:"ml-auto flex items-center space-x-2",children:e.jsx("button",{className:"btn-secondary text-sm",onClick:B,children:"light"===i?"深色":"浅色"})})]}),e.jsxs("div",{className:"h-12 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center px-4 flex-shrink-0 relative",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{onOpen:I,onSave:V,onNew:H,isDirty:S,currentFile:j,theme:i}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),e.jsx("button",{className:"btn-secondary text-sm",onClick:q,children:"格式化"}),e.jsx("button",{className:"btn-secondary text-sm",onClick:G,children:"压缩"}),e.jsx("button",{className:"btn-secondary text-sm",onClick:Q,children:"验证"}),e.jsx("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600"}),e.jsx("button",{className:"btn-secondary text-sm",onClick:J,children:"设置"})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(m,{isVisible:!0,onClose:()=>{},onSearch:(e,t)=>{if(F.current&&e.trim()){const n=F.current.getEditor();if(n){const s=n.getContribution("editor.contrib.findController");if(s&&"function"==typeof s.getState)try{s.getState().change({searchString:e,isRegex:t.useRegex,matchCase:t.caseSensitive,wholeWord:t.wholeWord,searchScope:null,matchesPosition:null,matchesCount:null},!1),s.start({forceRevealReplace:!1,seedSearchStringFromSelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:!0})}catch(r){n.trigger("keyboard","actions.find",{})}else n.trigger("keyboard","actions.find",{})}}},onReplace:(e,t,r)=>{if(F.current&&e.trim()){const s=F.current.getEditor();if(s){const o=s.getContribution("editor.contrib.findController");if(o&&"function"==typeof o.getState)try{o.getState().change({searchString:e,replaceString:t,isRegex:r.useRegex,matchCase:r.caseSensitive,wholeWord:r.wholeWord,searchScope:null,matchesPosition:null,matchesCount:null},!1),o.replace&&o.replace()}catch(n){s.trigger("keyboard","editor.action.startFindReplaceAction",{})}else s.trigger("keyboard","editor.action.startFindReplaceAction",{})}}},onReplaceAll:(e,t,r)=>{if(F.current&&e.trim()){const s=F.current.getEditor();if(s){const o=s.getContribution("editor.contrib.findController");if(o&&"function"==typeof o.getState)try{o.getState().change({searchString:e,replaceString:t,isRegex:r.useRegex,matchCase:r.caseSensitive,wholeWord:r.wholeWord,searchScope:null,matchesPosition:null,matchesCount:null},!1),o.replaceAll&&o.replaceAll()}catch(n){s.trigger("keyboard","editor.action.startFindReplaceAction",{})}else s.trigger("keyboard","editor.action.startFindReplaceAction",{})}}},onFindNext:()=>{if(F.current){const e=F.current.getEditor();e&&e.trigger("keyboard","editor.action.nextMatchFindAction",{})}},onFindPrevious:()=>{if(F.current){const e=F.current.getEditor();e&&e.trigger("keyboard","editor.action.previousMatchFindAction",{})}},searchResults:[],currentResultIndex:0,theme:i})})]}),e.jsx("main",{className:"flex-1 flex overflow-hidden relative",children:e.jsx("div",{className:"flex-1 p-4",children:e.jsx(u,{onFileDrop:I,onError:e=>{z("文件错误",e)},theme:i,children:e.jsx("div",{className:"editor-container h-full",children:e.jsx(n,{ref:F,value:r,onChange:e=>{U(e)},onValidationChange:e=>{a(e)},onCursorPositionChange:e=>{p(e)},onSelectionChange:e=>{b(e)},theme:i,settings:$})})})})}),e.jsxs("footer",{className:"h-6 bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 flex items-center px-4 text-xs text-gray-600 dark:text-gray-400 flex-shrink-0",children:[e.jsx("span",{children:0===o.length?e.jsx("span",{className:"text-green-600 dark:text-green-400",children:"✓ JSON 有效"}):e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["✗ ",o.length," 个错误"]})}),e.jsxs("span",{className:"ml-4",children:["行 ",h.line,", 列 ",h.column]}),y.startLine!==y.endLine||y.startColumn!==y.endColumn?e.jsxs("span",{className:"ml-4",children:["(已选择 ",Math.abs(y.endLine-y.startLine)+1," 行, ",y.startLine===y.endLine?Math.abs(y.endColumn-y.startColumn):"多个"," 字符)"]}):null,e.jsxs("span",{className:"ml-auto",children:["字符数: ",r.length]})]}),e.jsx(l,{isOpen:k,onClose:()=>v(!1),settings:$,onSettingsChange:e=>{P(t=>({...t,...e}))},theme:i,onThemeChange:d}),e.jsx(x,{toasts:M,onRemoveToast:O,position:"top-right"}),e.jsx(f,{isOpen:K,onClose:A,title:T.title,type:T.type,actions:T.showCancel?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{T.onConfirm?.(),A()},children:T.confirmText||"确定"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600 dark:hover:bg-gray-600",onClick:()=>{T.onCancel?.(),A()},children:T.cancelText||"取消"})]}):e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{T.onConfirm?.(),A()},children:T.confirmText||"确定"}),children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:T.message})})]})})}export{p as default};
//# sourceMappingURL=App.Due9r3vf.js.map
